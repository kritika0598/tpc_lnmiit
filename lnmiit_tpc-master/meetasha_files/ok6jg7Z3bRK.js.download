if (self.CavalryLogger) { CavalryLogger.start_js(["Ntwkh"]); }

__d('degToRad',[],(function a(b,c,d,e,f,g){'use strict';function h(i){return i*Math.PI/180}f.exports=h}),null);
__d('SphericalPhotoProjectionUtils',['GLMatrix','degToRad','radToDeg'],(function a(b,c,d,e,f,g){'use strict';var h=c('GLMatrix').glMatrix,i=c('GLMatrix').mat4,j=c('GLMatrix').vec3,k={getMaxMinVfov:function l(m,n){var o=c('degToRad')(m.partialRightDegrees||180),p=c('degToRad')(m.partialLeftDegrees||180),q=c('degToRad')(m.partialTopDegrees||90),r=c('degToRad')(m.partialBottomDegrees||90),s=(o+p)/2,t=(q+r)/2,u=2*Math.atan(s/n),v=this.getMinFullVfov(t,t);return {maxVfov:c('radToDeg')(Math.max(u,v)),minVfov:c('radToDeg')(Math.min(v,u/2))}},getMaxVfov:function l(m,n){return this.getMaxMinVfov(m,n).maxVfov},getMinFullVfov:function l(m,n){return Math.atan(m)+Math.atan(n)},getMinFullHfov:function l(m,n){return Math.atan(m)+Math.atan(n)},getZoomProgressFromFov:function l(m,n,o){return Math.max(0,Math.min(1,(m-o)/(n-o)))},getZoomProgress:function l(m,n,o){var p=this.getMaxMinVfov(n,o),q=p.maxVfov,r=p.minVfov;return this.getZoomProgressFromFov(m,q,r)},getHfov:function l(m,n){var o=2*Math.atan(Math.tan(m/2)*n);return o},normalizeLimits:function l(m){var n=m.partialLeftDegrees||0,o=m.partialRightDegrees||0,p=m.partialTopDegrees||0,q=m.partialBottomDegrees||0;if(n<0&&o<0){var r=Math.max(n,o);n-=r;o-=r}if(p<0&&q<0){var s=Math.max(p,q);p-=s;q-=s}return {partialLeftDegrees:n,partialRightDegrees:o,partialTopDegrees:p,partialBottomDegrees:q}},getPartialLimits:function l(m,n,o){var p=this.getMaxMinVfov(o,n),q=p.maxVfov,r=p.minVfov,s=c('degToRad')(m),t=this.getHfov(s,n),u=this.getZoomProgressFromFov(m,q,r),v=Math.tan(t/2),w=Math.tan(s/2),x=Math.sin(v)*u+v*(1-u),y=Math.cos(v)*u+1*(1-u),z=Math.sin(w)*u+w*(1-u),aa=Math.cos(w)*u+1*(1-u),ba=function ga(ha,ia,ja){var ka=Math.sin(ha),la=Math.cos(ha);return m>q?0:c('radToDeg')(Math.atan2(ka*ja-la*ia,ka*ia+la*ja))},ca=c('degToRad')(o.partialLeftDegrees||180),da=c('degToRad')(o.partialRightDegrees||180),ea=c('degToRad')(o.partialTopDegrees||90),fa=c('degToRad')(o.partialBottomDegrees||90);return this.normalizeLimits({partialLeftDegrees:ba(ca,x,y),partialRightDegrees:ba(da,x,y),partialTopDegrees:ba(ea,z,aa),partialBottomDegrees:ba(fa,z,aa)})},projectVertex:function l(m,n,o,p){var q=m[0],r=m[1],s=o?Math.sin(q):Math.sin(q)*Math.cos(r),t=o?r:Math.sin(r),u=o?Math.cos(q):Math.cos(q)*Math.cos(r);s=p*s+(1-p)*q;t=p*t+(1-p)*r;u=p*u+(1-p)*1;var v=j.fromValues(s,t,u);j.transformMat4(v,v,n);return v},getSphericalFromVertex:function l(m){var n=m[0],o=m[1],p=m[2],q=Math.atan2(n,p),r=Math.atan2(o,Math.sqrt(n*n+p*p));return {yaw:q,pitch:r}},getRelativeHfov:function l(m,n,o){var p=this.getPartialLimits(m,n,o),q=o.partialLeftDegrees||180,r=o.partialRightDegrees||180,s=p.partialLeftDegrees||0,t=p.partialRightDegrees||0;return c('degToRad')(r-t+q-s)},getRelativeVfov:function l(m,n,o){var p=this.getPartialLimits(m,n,o),q=o.partialTopDegrees||90,r=o.partialBottomDegrees||90,s=p.partialTopDegrees||0,t=p.partialBottomDegrees||0;return c('degToRad')(q-s+r-t)},convert2dTo3d:function l(m,n,o,p,q,r){var s=p/q,t=p/2,u=q/2,v=(m-t)*(2/p),w=(n-u)*(2/q),x=c('degToRad')(o.fov),y=this.getHfov(x,s),z=this.getMinFullHfov(c('degToRad')(r.partialLeftDegrees||180),c('degToRad')(r.partialRightDegrees||180)),aa=Math.tan(x/2),ba=Math.tan(y/2),ca=Math.tan(Math.min(y,z)/2),da=v*ba,ea=-w*aa;if(da>ca||da<-ca)return null;var fa=this.getZoomProgress(o.fov,r,s),ga=i.create();i.rotateY(ga,ga,c('degToRad')(o.yaw));i.rotateX(ga,ga,-c('degToRad')(o.pitch));var ha=this.projectVertex(j.fromValues(da,ea,-1),ga,false,fa),ia=this.getSphericalFromVertex(ha),ja=c('radToDeg')(ia.yaw);return {yaw:ja<0?360+ja:ja,pitch:c('radToDeg')(ia.pitch)}},convert3dTo2d:function l(m,n,o,p,q,r){var s=c('degToRad')(m),t=c('degToRad')(n),u=c('degToRad')(o.fov),v=p/q,w=this.getHfov(u,v),x=this.getMinFullHfov(c('degToRad')(r.partialLeftDegrees||180),c('degToRad')(r.partialRightDegrees||180)),y=Math.tan(w/2),z=Math.tan(Math.min(w,x)/2),aa=z/y,ba=this.getMinFullVfov(c('degToRad')(r.partialTopDegrees||90),c('degToRad')(r.partialBottomDegrees||90)),ca=Math.tan(u/2),da=Math.tan(Math.min(u,ba)/2),ea=da/ca,fa=this.getRelativeHfov(o.fov,v,r),ga=this.getRelativeVfov(o.fov,v,r),ha=i.create();i.rotateY(ha,ha,c('degToRad')(o.yaw));i.rotateX(ha,ha,-c('degToRad')(o.pitch));i.invert(ha,ha);var ia=s+Math.PI,ja=t+Math.PI/2,ka=-Math.sin(ja)*Math.sin(ia),la=-Math.cos(ja),ma=-Math.sin(ja)*Math.cos(ia),na=j.fromValues(ka,la,ma);j.transformMat4(na,na,ha);var oa=Math.atan2(na[0],na[2]),pa=Math.atan2(na[1],Math.sqrt(na[0]*na[0]+na[2]*na[2])),qa=.5+oa*aa/fa,ra=.5-pa*ea/ga;return {x:qa*p,y:ra*q}}};f.exports=k}),null);
__d('SphericalViewportControl',['cx','CSS','DOMQuery','Event','EventEmitter','Keys','Map','SphericalPhotoConfig','SubscriptionsHandler','UserAgent','VelocityTracker','SphericalPhotoProjectionUtils','debounce','getElementRect','performanceNow','requestAnimationFrame','throttle','uniqueID','degToRad','radToDeg','queryThenMutateDOM'],(function a(b,c,d,e,f,g,h){var i,j,k=c('DOMQuery').scry(window.document.body,"_li")[0]||window.document.body,l=2.5,m=20,n=110,o=179,p=.01,q=1000,r=.5,s=['W','A','S','D'].reduce(function(v,w){v[w]=w.charCodeAt(0);return v},{}),t={Up:"__tu",Down:"__tz",Left:"_2a6u",Right:"_2a6v",UpLeft:"__t-",UpRight:"__u0",DownLeft:"__u1",DownRight:"__u3"};i=babelHelpers.inherits(u,c('EventEmitter'));j=i&&i.prototype;function u(v,w){var x=arguments.length<=2||arguments[2]===undefined?{}:arguments[2],y=arguments.length<=3||arguments[3]===undefined?false:arguments[3],z=arguments.length<=4||arguments[4]===undefined?k:arguments[4];'use strict';j.constructor.call(this);this.$SphericalViewportControl82=function(aa){event.deliberateSync=true;if(this.$SphericalViewportControl31)aa.preventDefault();this.$SphericalViewportControl102(aa);if(this.$SphericalViewportControl39)c('Event').kill(aa);}.bind(this);this.$SphericalViewportControl102=c('throttle')(function(aa){this.emit('wheelScroll',aa);if(!this.$SphericalViewportControl39)return;var ba=(aa.deltaX||0)+(aa.deltaY||0)+(aa.deltaZ||0),ca=ba/120*45/10;this.$SphericalViewportControl77(ca)}.bind(this),30);this.$SphericalViewportControl105=function(){var aa=c('performanceNow')(),ba=(aa-this.$SphericalViewportControl50)/1000;this.$SphericalViewportControl50=aa;this.$SphericalViewportControl106();if(!this.$SphericalViewportControl51)c('queryThenMutateDOM')(this.$SphericalViewportControl69.bind(this),function(){return null});var ca=this.$SphericalViewportControl89(),da=false;if(this.$SphericalViewportControl35&&this.$SphericalViewportControl45&&this.$SphericalViewportControl40&&!this.$SphericalViewportControl12&&!this.$SphericalViewportControl13){var ea=this.$SphericalViewportControl107()*ba;ca.x+=ea;var fa=this.$SphericalViewportControl108()*ba;ca.y+=fa;if(ea||fa)da=true;}ca.x+=this.$SphericalViewportControl2.getVelocityX()*ba;ca.y+=this.$SphericalViewportControl2.getVelocityY()*ba;ca.x+=this.$SphericalViewportControl3.getVelocityX()*ba;ca.y+=this.$SphericalViewportControl3.getVelocityY()*ba;this.$SphericalViewportControl109(ca.x,ca.y);var ga=this.$SphericalViewportControl2.getSpeed()>0||this.$SphericalViewportControl3.getSpeed()>0;if(this.$SphericalViewportControl12||this.$SphericalViewportControl11||this.$SphericalViewportControl13||this.$SphericalViewportControl48||this.$SphericalViewportControl38||ga||da){c('requestAnimationFrame')(this.$SphericalViewportControl105)}else{this.$SphericalViewportControl8=false;this.emit('updateViewportEnd',this.$SphericalViewportControl19.x,this.$SphericalViewportControl19.y)}}.bind(this);this.$SphericalViewportControl2=new (c('VelocityTracker'))(300);this.$SphericalViewportControl3=new (c('VelocityTracker'))(300);this.$SphericalViewportControl6=new (c('SubscriptionsHandler'))();this.$SphericalViewportControl25=v;this.$SphericalViewportControl4=z;this.$SphericalViewportControl44=m;this.$SphericalViewportControl54=y;this.$SphericalViewportControl55(w);this.$SphericalViewportControl14={x:0,y:0};this.$SphericalViewportControl50=0;this.$SphericalViewportControl10={left:0,right:0,up:0,down:0};this.$SphericalViewportControl16={x:0,y:0};this.$SphericalViewportControl17={x:0,y:0};this.$SphericalViewportControl18=new (c('VelocityTracker'))();this.$SphericalViewportControl23=new (c('Map'))();this.$SphericalViewportControl31=false;this.$SphericalViewportControl15=false;this.$SphericalViewportControl20=false;this.$SphericalViewportControl36=x.enableGyro||false;this.$SphericalViewportControl37=x.slipFactor||0;this.$SphericalViewportControl40=x.springFactor||0;this.$SphericalViewportControl41=x.maxSpringDegrees||15;this.$SphericalViewportControl42=x.maxStretchXDegrees||20;this.$SphericalViewportControl43=x.maxStretchYDegrees||20;this.$SphericalViewportControl46=x.rubberBandConstant||0;this.$SphericalViewportControl45=x.enableRubberBanding||false;this.$SphericalViewportControl48=false;this.$SphericalViewportControl49=0;this.$SphericalViewportControl47=c('debounce')(function(){return this.emit('zoomStart')}.bind(this),q);this.$SphericalViewportControl30=this.$SphericalViewportControl56();this.$SphericalViewportControl51=x.disableAutoClientSizeUpdate||false;this.$SphericalViewportControl52=[];this.$SphericalViewportControl53=false;this.$SphericalViewportControl24=this.addNewLayer(this.$SphericalViewportControl25)}u.prototype.isListening=function(v){'use strict';return Boolean(this.getSubscriptionKeyFromElement(v))};u.prototype.getSubscriptionKeyFromElement=function(v){'use strict';for(var w=this.$SphericalViewportControl23,x=Array.isArray(w),y=0,w=x?w:w[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var z;if(x){if(y>=w.length)break;z=w[y++]}else{y=w.next();if(y.done)break;z=y.value}var aa=z,ba=aa[0],ca=aa[1];if(ca.element===v)return ba;}return null};u.prototype.addNewLayer=function(v){'use strict';var w=this.getSubscriptionKeyFromElement(v);if(!w){w=c('uniqueID')();var x=new (c('SubscriptionsHandler'))();this.$SphericalViewportControl57(x,v);this.$SphericalViewportControl23.set(w,{handler:x,element:v})}return w};u.prototype.removeLayer=function(v){'use strict';var w=this.$SphericalViewportControl23.get(v);if(w){w.handler.release();this.$SphericalViewportControl23['delete'](v)}};u.prototype.destroy=function(){'use strict';this.removeAllListeners();this.getSubscriptions().remove()};u.prototype.$SphericalViewportControl57=function(v,w){'use strict';v.addSubscriptions(c('Event').listen(w,'mousedown',function(x){return this.$SphericalViewportControl58(x)}.bind(this)),c('Event').listen(w,'mouseenter',function(x){return this.$SphericalViewportControl59(x,w)}.bind(this)),c('Event').listen(w,'mouseleave',function(x){return this.$SphericalViewportControl60(x,w)}.bind(this)),c('Event').listen(w,'mousemove',function(x){return this.$SphericalViewportControl61(x)}.bind(this)),c('Event').listen(w,'click',function(x){return this.$SphericalViewportControl62(x)}.bind(this)),c('Event').listen(w,'keydown',function(x){return this.$SphericalViewportControl63(x)}.bind(this)),c('Event').listen(w,'keyup',function(x){return this.$SphericalViewportControl64(x)}.bind(this)),c('Event').listen(w,'blur',function(x){return this.$SphericalViewportControl65(x)}.bind(this)),c('Event').listen(w,'touchstart',function(x){return this.$SphericalViewportControl66(x)}.bind(this)),c('Event').listen(w,'touchmove',function(x){return this.$SphericalViewportControl67(x)}.bind(this)),c('Event').listen(w,'touchend',function(x){return this.$SphericalViewportControl68(x)}.bind(this)),c('Event').listen(w,'touchcancel',function(x){return this.$SphericalViewportControl68(x)}.bind(this)))};u.prototype.$SphericalViewportControl55=function(v){'use strict';this.$SphericalViewportControl69();this.$SphericalViewportControl1=this.$SphericalViewportControl27/this.$SphericalViewportControl28;var w=v.fieldOfView;this.$SphericalViewportControl39=Boolean(v.enableZoom);this.$SphericalViewportControl22=(v.panningVelocityFactor||0)/15*80||80;this.$SphericalViewportControl9=(v.keyboardVelocityFactor||0)*1000||80;if(v.partialLimits){this.$SphericalViewportControl32=v.partialLimits;this.$SphericalViewportControl35=true}else{this.$SphericalViewportControl35=false;this.$SphericalViewportControl32={partialLeftDegrees:null,partialRightDegrees:null,partialTopDegrees:null,partialBottomDegrees:null}}this.$SphericalViewportControl33=this.$SphericalViewportControl32;this.$SphericalViewportControl34=1;if(this.$SphericalViewportControl54)this.$SphericalViewportControl35=true;this.$SphericalViewportControl21={x:v.initialHeading,y:v.initialPitch};var x=this.$SphericalViewportControl32,y=x.partialTopDegrees,z=x.partialBottomDegrees;if(!this.$SphericalViewportControl54&&(y||y===0)&&(z||z===0)){var aa=y,ba=z,ca=aa+ba;if(w>ca){w=ca;this.$SphericalViewportControl21.y=(aa-ba)/2}}this.$SphericalViewportControl5=this.$SphericalViewportControl70(w);this.$SphericalViewportControl71();this.$SphericalViewportControl19={x:this.$SphericalViewportControl21.x,y:this.$SphericalViewportControl21.y}};u.prototype.reconfigure=function(v){'use strict';this.$SphericalViewportControl55(v)};u.prototype.setEnableGyro=function(v){'use strict';this.$SphericalViewportControl36=v};u.prototype.$SphericalViewportControl58=function(v){'use strict';if(this.$SphericalViewportControl13)this.$SphericalViewportControl72();if(this.isListening(v.target)){this.$SphericalViewportControl12=true;this.$SphericalViewportControl73(v)}};u.prototype.$SphericalViewportControl66=function(v){'use strict';this.$SphericalViewportControl53=false;if(this.$SphericalViewportControl12)this.$SphericalViewportControl72();if(this.$SphericalViewportControl13){this.$SphericalViewportControl74(v);this.$SphericalViewportControl13=false;this.$SphericalViewportControl72()}else this.$SphericalViewportControl13=true;this.$SphericalViewportControl73(v)};u.prototype.$SphericalViewportControl74=function(v){'use strict';if(v.touches.length===2&&this.$SphericalViewportControl39){this.$SphericalViewportControl48=true;this.$SphericalViewportControl49=this.$SphericalViewportControl75(v)}};u.prototype.$SphericalViewportControl67=function(v){'use strict';this.$SphericalViewportControl53=true;if(this.$SphericalViewportControl48){this.$SphericalViewportControl76(v);if(this.$SphericalViewportControl39)c('Event').kill(v);}};u.prototype.$SphericalViewportControl76=function(v){'use strict';var w=this.$SphericalViewportControl75(v),x=this.$SphericalViewportControl5*(this.$SphericalViewportControl49/w),y=x-this.$SphericalViewportControl5;this.$SphericalViewportControl77(y);this.$SphericalViewportControl49=w};u.prototype.$SphericalViewportControl75=function(v){'use strict';var w=v.touches[0].pageX-v.touches[1].pageX,x=v.touches[0].pageY-v.touches[1].pageY;return Math.sqrt(Math.pow(w,2)+Math.pow(x,2))};u.prototype.$SphericalViewportControl68=function(v){'use strict';if(!this.$SphericalViewportControl53&&c('SphericalPhotoConfig').is_www_tap_to_click_on){v.target.focus(v);this.$SphericalViewportControl62(v)}if(this.$SphericalViewportControl48){this.$SphericalViewportControl48=false}else if(this.$SphericalViewportControl13)this.$SphericalViewportControl60(v,null);};u.prototype.$SphericalViewportControl73=function(v){'use strict';this.$SphericalViewportControl78();this.$SphericalViewportControl79(v);this.$SphericalViewportControl80(v);this.$SphericalViewportControl81();v.preventDefault()};u.prototype.$SphericalViewportControl60=function(v,w){'use strict';if(w)w.removeEventListener('wheel',this.$SphericalViewportControl82);if(this.$SphericalViewportControl38&&!this.$SphericalViewportControl12){this.$SphericalViewportControl83();this.$SphericalViewportControl38=false}};u.prototype.$SphericalViewportControl84=function(v){'use strict';if(this.$SphericalViewportControl13||this.$SphericalViewportControl12)this.$SphericalViewportControl72();};u.prototype.$SphericalViewportControl85=function(v){'use strict';this.$SphericalViewportControl80(v);this.$SphericalViewportControl7=true;this.emit('updateViewportMove')};u.prototype.$SphericalViewportControl86=function(v){'use strict';if(this.$SphericalViewportControl38){this.$SphericalViewportControl87(v);this.emit('updateViewportMove')}};u.prototype.$SphericalViewportControl78=function(){'use strict';this.$SphericalViewportControl8=false;this.$SphericalViewportControl38=false;this.$SphericalViewportControl36=false};u.prototype.$SphericalViewportControl88=function(v){'use strict';this.$SphericalViewportControl80(v);this.$SphericalViewportControl89();this.$SphericalViewportControl72();this.$SphericalViewportControl83();v.preventDefault()};u.prototype.$SphericalViewportControl72=function(v){'use strict';c('queryThenMutateDOM')(function(){},function(){return this.$SphericalViewportControl25.style.cursor=''}.bind(this));this.$SphericalViewportControl13=false;this.$SphericalViewportControl12=false;this.$SphericalViewportControl6.release();if(this.$SphericalViewportControl29){c('CSS').removeClass(this.$SphericalViewportControl4,this.$SphericalViewportControl29);this.$SphericalViewportControl29=''}};u.prototype.$SphericalViewportControl90=function(v){'use strict';if(this.$SphericalViewportControl13&&v.changedTouches){return v.changedTouches[0]}else if(this.$SphericalViewportControl12){return v}else if(this.$SphericalViewportControl38)return v;return null};u.prototype.$SphericalViewportControl91=function(v){'use strict';var w=this.$SphericalViewportControl90(v);if(!w)return this.$SphericalViewportControl16;return {x:w.screenX,y:w.screenY}};u.prototype.$SphericalViewportControl92=function(v){'use strict';var w=this.$SphericalViewportControl90(v);if(!w)return this.$SphericalViewportControl17;return {x:w.clientX,y:w.clientY}};u.prototype.$SphericalViewportControl79=function(v){'use strict';this.$SphericalViewportControl16=this.$SphericalViewportControl91(v);this.$SphericalViewportControl14={x:0,y:0};this.$SphericalViewportControl18=new (c('VelocityTracker'))();this.$SphericalViewportControl3=new (c('VelocityTracker'))(300);c('queryThenMutateDOM')(function(){},function(){return this.$SphericalViewportControl25.style.cursor=this.$SphericalViewportControl30}.bind(this));this.$SphericalViewportControl6.engage();var w=this.$SphericalViewportControl4;if(this.$SphericalViewportControl13){this.$SphericalViewportControl6.addSubscriptions(c('Event').listen(w,'touchmove',function(x){return this.$SphericalViewportControl85(x)}.bind(this)),c('Event').listen(w,'touchend',function(x){return this.$SphericalViewportControl88(x)}.bind(this)),c('Event').listen(w,'touchcancel',function(x){return this.$SphericalViewportControl84(x)}.bind(this)))}else this.$SphericalViewportControl6.addSubscriptions(c('Event').listen(w,'mousemove',function(x){return this.$SphericalViewportControl85(x)}.bind(this)),c('Event').listen(w,'mouseup',function(x){return this.$SphericalViewportControl88(x)}.bind(this)),c('Event').listen(w,'mouseleave',function(x){return this.$SphericalViewportControl84(x)}.bind(this)));};u.prototype.$SphericalViewportControl87=function(v){'use strict';this.$SphericalViewportControl93(v,this.$SphericalViewportControl37)};u.prototype.$SphericalViewportControl80=function(v){'use strict';this.$SphericalViewportControl93(v,1)};u.prototype.$SphericalViewportControl93=function(v,w){'use strict';var x=this.$SphericalViewportControl91(v),y=this.$SphericalViewportControl15?{x:0,y:0}:this.$SphericalViewportControl14;this.$SphericalViewportControl14={x:w*(x.x-this.$SphericalViewportControl16.x)+y.x,y:w*(x.y-this.$SphericalViewportControl16.y)+y.y};this.$SphericalViewportControl15=false;this.$SphericalViewportControl16=x;this.$SphericalViewportControl18.update(x.x,x.y);this.$SphericalViewportControl17=this.$SphericalViewportControl92(v)};u.prototype.$SphericalViewportControl94=function(){'use strict';var v=this.$SphericalViewportControl95(),w=-this.$SphericalViewportControl18.getVelocityX()*v,x=this.$SphericalViewportControl18.getVelocityY()*v,y=this.$SphericalViewportControl38?this.$SphericalViewportControl37:1;if(this.$SphericalViewportControl96())w=-w;return {x:w*y,y:x*y}};u.prototype.$SphericalViewportControl97=function(v,w){'use strict';return c('radToDeg')(Math.atan(v/w))};u.prototype.$SphericalViewportControl98=function(v,w,x){'use strict';return {x:this.$SphericalViewportControl97(v.x-this.$SphericalViewportControl27/2,x),y:-this.$SphericalViewportControl97(v.y-this.$SphericalViewportControl28/2,w)}};u.prototype.$SphericalViewportControl99=function(v,w){'use strict';var x={x:v.x-w.x,y:v.y-w.y},y=this.$SphericalViewportControl28/(2*Math.tan(c('degToRad')(this.getVerticalFieldOfView()/2))),z=y*Math.cos(c('degToRad')(this.$SphericalViewportControl19.y)),aa=z-(this.$SphericalViewportControl28/2-v.y)*Math.sin(c('degToRad')(this.$SphericalViewportControl19.y));if(this.$SphericalViewportControl19.y==-90&&w.y<0||this.$SphericalViewportControl19.y==90&&w.y>0){var ba=this.$SphericalViewportControl97(x.y-this.$SphericalViewportControl28/2,x.x-this.$SphericalViewportControl27/2),ca=this.$SphericalViewportControl97(v.y-this.$SphericalViewportControl28/2,v.x-this.$SphericalViewportControl27/2),da=ca-ba;if(da>90){da=180-da}else if(da<-90)da=180+da;return {x:da*Math.sign(this.$SphericalViewportControl19.y),y:0}}else{var ea=this.$SphericalViewportControl98(x,y,aa),fa=this.$SphericalViewportControl98(v,y,aa);return {x:ea.x-fa.x,y:ea.y-fa.y}}};u.prototype.$SphericalViewportControl96=function(){'use strict';var v=this.$SphericalViewportControl26?this.$SphericalViewportControl26.top:c('getElementRect')(this.$SphericalViewportControl25).top,w=this.$SphericalViewportControl17.y-v,x=this.$SphericalViewportControl28/(2*Math.tan(c('degToRad')(this.getVerticalFieldOfView()/2))),y=-x/Math.tan(c('degToRad')(this.$SphericalViewportControl19.y))+this.$SphericalViewportControl28/2,z=w>y&&this.$SphericalViewportControl19.y<0||w<y&&this.$SphericalViewportControl19.y>0;return z};u.prototype.$SphericalViewportControl89=function(){'use strict';var v={x:0,y:0};if(!this.$SphericalViewportControl15){this.$SphericalViewportControl15=true;var w=this.$SphericalViewportControl26,x=this.$SphericalViewportControl17.x<w.left,y=this.$SphericalViewportControl17.x>w.right,z=this.$SphericalViewportControl17.y<w.top,aa=this.$SphericalViewportControl17.y>w.bottom;this.$SphericalViewportControl100(x,y,z,aa);var ba={x:this.$SphericalViewportControl17.x-w.left,y:this.$SphericalViewportControl17.y-w.top};if(!x&&!y){v.x=this.$SphericalViewportControl99(ba,this.$SphericalViewportControl14).x}else v.x=-this.$SphericalViewportControl14.x*this.$SphericalViewportControl95()*r;if(!z&&!aa){v.y=this.$SphericalViewportControl99(ba,this.$SphericalViewportControl14).y}else v.y=this.$SphericalViewportControl14.y*this.$SphericalViewportControl95()*r;}this.$SphericalViewportControl3.updateVelocity(0,0);return this.$SphericalViewportControl101(v)};u.prototype.$SphericalViewportControl101=function(v){'use strict';if(!this.$SphericalViewportControl45||!this.$SphericalViewportControl35)return v;var w=this.$SphericalViewportControl19,x=w.x,y=w.y,z=this.$SphericalViewportControl33,aa=z.partialLeftDegrees,ba=z.partialRightDegrees,ca=z.partialTopDegrees,da=z.partialBottomDegrees,ea=v.x,fa=v.y,ga=x+ea,ha=y+fa,ia=true,ja=true,ka=true,la=true;if(this.$SphericalViewportControl54){var ma=this.$SphericalViewportControl32.partialLeftDegrees,na=this.$SphericalViewportControl32.partialRightDegrees,oa=this.$SphericalViewportControl34===0;if(ga<180&&ea<0||ga>180&&ea>0)ga=x-ea;if((ma!=null||!oa)&&aa!=null)ia=aa<0?(ga<180?ga+360:ga)>360-aa:ga>360-aa;if((na!=null||!oa)&&ba!=null)ja=ba<0?(ga<180?ga+360:ga)<360+ba:(ga>180?360-ga:ga)<ba;ka=ca!=null?ha<ca:true;la=da!=null?ha>-da:true}else{var pa=this.getVerticalFieldOfView(),qa=this.getHorizontalFieldOfView(),ra=ga<180?ga+360:ga,sa=ga>180?ga-360:ga;ia=aa!=null?ra>360-aa+qa/2:true;ja=ba!=null?sa<ba-qa/2:true;ka=ca!=null?ha<ca-pa/2:true;la=da!=null?ha>-da+pa/2:true}if(!ia&&!ja)ea*=this.$SphericalViewportControl46;if(!ka||!la)fa*=this.$SphericalViewportControl46;return {x:ea,y:fa}};u.prototype.$SphericalViewportControl59=function(v,w){'use strict';w.addEventListener('wheel',this.$SphericalViewportControl82);this.emit('mouseEnter');if(this.$SphericalViewportControl12){this.$SphericalViewportControl3=new (c('VelocityTracker'))(300)}else if(this.$SphericalViewportControl36&&this.$SphericalViewportControl37){this.$SphericalViewportControl3=new (c('VelocityTracker'))(300);this.$SphericalViewportControl38=true;this.$SphericalViewportControl16=this.$SphericalViewportControl91(v);this.$SphericalViewportControl14={x:0,y:0};this.$SphericalViewportControl81()}};u.prototype.$SphericalViewportControl61=function(v){'use strict';this.emit('mouseMove',v);if(this.$SphericalViewportControl36)this.$SphericalViewportControl86(v);};u.prototype.$SphericalViewportControl62=function(v){'use strict';if(this.isListening(v.target)){v.target.focus();if(!this.$SphericalViewportControl7)this.emit('DOM/click',v);this.$SphericalViewportControl7=false}return false};u.prototype.$SphericalViewportControl77=function(v){'use strict';var w=this.setFieldOfView(this.$SphericalViewportControl5+v);if(w)this.$SphericalViewportControl47();};u.prototype.disableKeyboard=function(){'use strict';this.$SphericalViewportControl20=true};u.prototype.enableKeyboard=function(){'use strict';this.$SphericalViewportControl20=false};u.prototype.$SphericalViewportControl63=function(v){'use strict';var w=this.$SphericalViewportControl103(v);if(w&&!this.$SphericalViewportControl20){this.$SphericalViewportControl10[w]=1;if(!this.$SphericalViewportControl11){this.$SphericalViewportControl11=true;this.$SphericalViewportControl78();this.$SphericalViewportControl81();this.emit('updateViewportMove')}return false}return true};u.prototype.$SphericalViewportControl64=function(v){'use strict';var w=this.$SphericalViewportControl103(v);if(w&&!this.$SphericalViewportControl20){this.$SphericalViewportControl10[w]=0;var x=false;for(var y in this.$SphericalViewportControl10)if(Object.prototype.hasOwnProperty.call(this.$SphericalViewportControl10,y)&&this.$SphericalViewportControl10[y]>0){x=true;break}this.$SphericalViewportControl11=x;return false}return true};u.prototype.$SphericalViewportControl83=function(){'use strict';var v=this.$SphericalViewportControl94();this.$SphericalViewportControl3=new (c('VelocityTracker'))(300,v)};u.prototype.$SphericalViewportControl81=function(){var v,w=this;'use strict';if(!this.$SphericalViewportControl8)(function(){if(w.$SphericalViewportControl51)w.$SphericalViewportControl104();w.$SphericalViewportControl8=true;w.$SphericalViewportControl2.updateVelocity(0,0);w.emit('updateViewportBegin');var x=w.once('updateViewportMove',function(){return this.emit('updateViewportMoveStart',this.$SphericalViewportControl38)}.bind(w));w.once('updateViewportEnd',function(){return x.remove()});w.$SphericalViewportControl50=c('performanceNow')();c('requestAnimationFrame')(w.$SphericalViewportControl105)})();};u.prototype.$SphericalViewportControl104=function(){'use strict';this.$SphericalViewportControl26=c('getElementRect')(this.$SphericalViewportControl25)};u.prototype.updateViewportClientSize=function(v){'use strict';this.$SphericalViewportControl27=v.width;this.$SphericalViewportControl28=v.height};u.prototype.updateMinVFOV=function(v){'use strict';this.$SphericalViewportControl44=Math.max(l,Math.min(m,v))};u.prototype.$SphericalViewportControl69=function(){'use strict';this.$SphericalViewportControl26=c('getElementRect')(this.$SphericalViewportControl25);this.$SphericalViewportControl27=this.$SphericalViewportControl25.clientWidth||1;this.$SphericalViewportControl28=this.$SphericalViewportControl25.clientHeight||1};u.prototype.$SphericalViewportControl107=function(){'use strict';var v=180,w=0,x=this.$SphericalViewportControl33,y=x.partialLeftDegrees,z=x.partialRightDegrees;if(y!=null&&z!=null)v=(z-y)/2+180;if(this.$SphericalViewportControl54){var aa=this.$SphericalViewportControl32.partialLeftDegrees,ba=this.$SphericalViewportControl32.partialRightDegrees,ca=this.$SphericalViewportControl34===0;if((aa!=null||!ca)&&y!=null){var da=y<0&&this.$SphericalViewportControl19.x<180?this.$SphericalViewportControl19.x+360:this.$SphericalViewportControl19.x;if(da>v){var ea=360-y-da;if(ea>0)w=Math.min(ea,this.$SphericalViewportControl41)*this.$SphericalViewportControl40;}}if((ba!=null||!ca)&&z!=null){var fa=z<0&&this.$SphericalViewportControl19.x>180?this.$SphericalViewportControl19.x-360:this.$SphericalViewportControl19.x;if(fa<v){var ga=z-fa;if(ga<0)w=Math.max(ga,-this.$SphericalViewportControl41)*this.$SphericalViewportControl40;}}}else{var ha=this.getHorizontalFieldOfView(),ia=this.$SphericalViewportControl19.x<180?this.$SphericalViewportControl19.x+360:this.$SphericalViewportControl19.x,ja=this.$SphericalViewportControl19.x>180?this.$SphericalViewportControl19.x-360:this.$SphericalViewportControl19.x;if(y!=null&&z!=null&&y+z<ha){var ka=(z-y)/2-ja;if(ka>0){w=Math.min(ka,this.$SphericalViewportControl41)*this.$SphericalViewportControl40}else if(ka<0)w=Math.max(ka,-this.$SphericalViewportControl41)*this.$SphericalViewportControl40;return Math.abs(w)<p?0:w}if(y!=null&&ia>=v){var la=360-y+ha/2-ia;if(la>0)w=Math.min(la,this.$SphericalViewportControl41)*this.$SphericalViewportControl40;}if(z!=null&&ja<=v){var ma=z-ha/2-ja;if(ma<0)w=Math.max(ma,-this.$SphericalViewportControl41)*this.$SphericalViewportControl40;}}return Math.abs(w)<p?0:w};u.prototype.$SphericalViewportControl108=function(){'use strict';var v=0,w=0,x=this.$SphericalViewportControl33,y=x.partialTopDegrees,z=x.partialBottomDegrees;if(this.$SphericalViewportControl54){if(z!=null&&y!=null){if(z<0&&y<-z||y<0&&-y>z)return 0;w=(y-z)/2}if(y!=null&&this.$SphericalViewportControl19.y>w){var aa=y-this.$SphericalViewportControl19.y;if(aa<0)v=Math.max(aa,-this.$SphericalViewportControl41)*this.$SphericalViewportControl40;}if(z!=null&&this.$SphericalViewportControl19.y<w){var ba=-z-this.$SphericalViewportControl19.y;if(ba>0)v=Math.min(ba,this.$SphericalViewportControl41)*this.$SphericalViewportControl40;}}else{var ca=this.getVerticalFieldOfView();if(z!=null&&y!=null&&z+y<ca){var da=(y-z)/2-this.$SphericalViewportControl19.y;if(da>0){v=Math.min(da,this.$SphericalViewportControl41)*this.$SphericalViewportControl40}else if(da<0)v=Math.max(da,-this.$SphericalViewportControl41)*this.$SphericalViewportControl40;return Math.abs(v)<p?0:v}if(y!=null){var ea=y-ca/2-this.$SphericalViewportControl19.y;if(ea<0)v=Math.max(ea,-this.$SphericalViewportControl41)*this.$SphericalViewportControl40;}if(z!=null){var fa=-z+ca/2-this.$SphericalViewportControl19.y;if(fa>0)v=Math.min(fa,this.$SphericalViewportControl41)*this.$SphericalViewportControl40;}}return Math.abs(v)<p?0:v};u.prototype.$SphericalViewportControl100=function(v,w,x,y){'use strict';var z='';if(v||w||x||y){var aa=v?'Left':w?'Right':'',ba=x?'Up':y?'Down':'';z=t[ba+aa]}if(this.$SphericalViewportControl29!=z){if(this.$SphericalViewportControl29){c('CSS').removeClass(this.$SphericalViewportControl4,this.$SphericalViewportControl29);this.$SphericalViewportControl29=''}if(z){this.$SphericalViewportControl29=z;c('CSS').addClass(this.$SphericalViewportControl4,z)}}};u.prototype.getSubscriptions=function(){'use strict';return {remove:function(){this.$SphericalViewportControl23.forEach(function(v){var w=v.handler;return w.release()});this.$SphericalViewportControl23.clear();this.$SphericalViewportControl6.release()}.bind(this)}};u.prototype.$SphericalViewportControl65=function(v){'use strict';for(var w in this.$SphericalViewportControl10)this.$SphericalViewportControl10[w]=0;this.$SphericalViewportControl11=false};u.prototype.getOrientation=function(){'use strict';return this.$SphericalViewportControl19};u.prototype.$SphericalViewportControl71=function(v){'use strict';if(this.$SphericalViewportControl54){var w=v!=null?v:this.getVerticalFieldOfView(),x=this.getAspectRatio();this.$SphericalViewportControl33=c('SphericalPhotoProjectionUtils').getPartialLimits(w,x,this.$SphericalViewportControl32);this.$SphericalViewportControl34=c('SphericalPhotoProjectionUtils').getZoomProgress(w,this.$SphericalViewportControl32,x)}};u.prototype.$SphericalViewportControl110=function(v,w){'use strict';var x=(v+360)%360,y=Math.max(-90,Math.min(90,w));if(!this.$SphericalViewportControl35)return {x:x,y:y};var z=this.$SphericalViewportControl32.partialLeftDegrees,aa=this.$SphericalViewportControl32.partialRightDegrees,ba=this.$SphericalViewportControl34===0,ca=this.$SphericalViewportControl33.partialLeftDegrees,da=this.$SphericalViewportControl33.partialRightDegrees,ea=this.$SphericalViewportControl33.partialTopDegrees,fa=this.$SphericalViewportControl33.partialBottomDegrees,ga=this.getVerticalFieldOfView(),ha=this.getHorizontalFieldOfView(),ia=0,ja=0;if(this.$SphericalViewportControl54){if(this.$SphericalViewportControl45){if(ca!=null&&da!=null)ia=Math.min(Math.abs((ca+da)/2),this.$SphericalViewportControl42);if(ea!=null&&fa!=null&&ea>=-fa)ja=Math.min(Math.abs((ea+fa)/2),this.$SphericalViewportControl43);}if((z!=null||!ba)&&ca!=null)if(ca<0){x=Math.max(x>180?x:x+360,360-ca-ia)%360}else if(x>180)x=Math.max(x,360-ca-ia);if((aa!=null||!ba)&&da!=null)if(da<0){x=Math.min(x<180?x+360:x,360+da+ia)%360}else if(x<180)x=Math.min(x,da+ia);if(ea!=null)if(fa!=null&&ea<0&&-ea>fa){y=Math.min(y,-fa)}else y=Math.min(y,ea+ja);if(fa!=null)if(ea!=null&&fa<0&&ea<-fa){y=Math.max(y,ea)}else y=Math.max(y,-fa-ja);}else{if(this.$SphericalViewportControl45){ia=this.$SphericalViewportControl42;ja=this.$SphericalViewportControl43}if(ca!=null&&da!=null&&ca+da<ha){var ka=(da-ca)/2,la=x>180?x-360:x;if(la<ka){x=Math.max(la,ka-ia)}else x=Math.min(la,ka+ia);}else{if(ca!=null)x=x<=180?x:Math.max(x,360-ca+ha/2-ia);if(da!=null)x=x>=180?x:Math.min(x,da-ha/2+ia);}if(ea!=null&&fa!=null&&ea+fa<ga){var ma=(ea-fa)/2;if(y<ma){y=Math.max(y,ma-ja)}else y=Math.min(y,ma+ja);}else{if(ea!=null)y=Math.min(y,ea-ga/2+ja);if(fa!=null)y=Math.max(y,-fa+ga/2-ja);}}return {x:x,y:y}};u.prototype.setInitialOrientation=function(){'use strict';var v=this.$SphericalViewportControl110(0,0),w=v.x,x=v.y,y=!Number.isNaN(w+x)&&(w!==this.$SphericalViewportControl19.x||x!==this.$SphericalViewportControl19.y);if(y){this.$SphericalViewportControl19={x:w,y:x};this.emit('initialViewportChange',w,x);this.emit('viewportChange',w,x,this.$SphericalViewportControl5)}};u.prototype.setSphericalOrientation=function(v,w){'use strict';var x=this.$SphericalViewportControl110(v,w),y=x.x,z=x.y,aa=!Number.isNaN(y+z)&&(y!==this.$SphericalViewportControl19.x||z!==this.$SphericalViewportControl19.y);if(aa){this.$SphericalViewportControl19={x:y,y:z};this.emit('viewportChange',y,z,this.$SphericalViewportControl5)}};u.prototype.setRelativeSphericalOrientation=function(v,w){'use strict';this.setSphericalOrientation(v+this.$SphericalViewportControl21.x,w+this.$SphericalViewportControl21.y)};u.prototype.$SphericalViewportControl109=function(v,w){'use strict';this.setSphericalOrientation(this.$SphericalViewportControl19.x+v,this.$SphericalViewportControl19.y+w)};u.prototype.$SphericalViewportControl70=function(v){'use strict';if(this.$SphericalViewportControl54){var w=c('SphericalPhotoProjectionUtils').getMaxVfov(this.$SphericalViewportControl32,this.getAspectRatio());return Math.min(w,Math.max(this.$SphericalViewportControl44,v))}else{var x=Math.min(o/this.getAspectRatio(),n);if(this.$SphericalViewportControl35&&this.$SphericalViewportControl32){var y=this.$SphericalViewportControl32.partialTopDegrees||this.$SphericalViewportControl32.partialTopDegrees===0,z=this.$SphericalViewportControl32.partialBottomDegrees||this.$SphericalViewportControl32.partialBottomDegrees===0;if(y&&z){var aa=this.$SphericalViewportControl32.partialTopDegrees||0,ba=this.$SphericalViewportControl32.partialBottomDegrees||0;x=Math.min(x,aa+ba)}}return Math.min(x,Math.max(this.$SphericalViewportControl44,v))}};u.prototype.setFieldOfView=function(v){'use strict';var w=this.$SphericalViewportControl5,x=this.$SphericalViewportControl70(v);this.$SphericalViewportControl71(x);var y=this.$SphericalViewportControl33,z=y.partialTopDegrees,aa=y.partialBottomDegrees,ba=y.partialLeftDegrees,ca=y.partialRightDegrees,da=z||z===0,ea=aa||aa===0,fa=ba||ba===0,ga=ca||ca===0,ha=ba||ca,ia=z||0,ja=aa||0,ka=ba||0,la=ca||0,ma=false,na=this.$SphericalViewportControl19.x,oa=this.$SphericalViewportControl19.y;if(this.$SphericalViewportControl54){ia=da?ia:90;ja=ea?ja:90;ka=fa?ka:180;la=ga?la:180;if(-oa>ja){if(ja<0&&ia<-ja){oa=ia}else oa=-ja;ma=true}if(oa>ia){if(ia<0&&ia<-ja){oa=-ja}else oa=ia;ma=true}var pa=((la-ka)/2+180)%360;if(na>pa&&360-na>ka){na=360-ka;ma=true}if(na<pa&&na>la){na=la;ma=true}}else{var qa=x*this.getAspectRatio();if(ea&&x/2-oa>ja){oa=x/2-ja;ma=true}if(da&&oa+x/2>ia){oa=ia-x/2;ma=true}if(da&&ea&&ia+ja<x){oa=(ia-ja)/2;ma=true}if(ha){var ra=((la-ka)/2+180)%360;if(na>ra&&qa/2+360-na>ka){na=360+qa/2-ka;ma=true}if(na<ra&&na+qa/2>la){na=la-qa/2;ma=true}if(ka+la<qa){na=(la-ka)/2%360;ma=true}}}if(ma&&!Number.isNaN(na+oa))this.$SphericalViewportControl19={x:na,y:oa};if(!Number.isNaN(x)&&w!==x||ma){this.$SphericalViewportControl5=x;this.emit('viewportChange',this.$SphericalViewportControl19.x,this.$SphericalViewportControl19.y,x);return true}return false};u.prototype.getVerticalFieldOfView=function(){'use strict';return this.$SphericalViewportControl5};u.prototype.getAspectRatio=function(){'use strict';if(this.$SphericalViewportControl25&&this.$SphericalViewportControl27&&this.$SphericalViewportControl28)return this.$SphericalViewportControl27/this.$SphericalViewportControl28;return this.$SphericalViewportControl1};u.prototype.getHorizontalFieldOfView=function(){'use strict';return this.$SphericalViewportControl5*this.getAspectRatio()};u.prototype.setPreventScrollDefaultAction=function(v){'use strict';this.$SphericalViewportControl31=v};u.prototype.updateViewport=function(v,w,x){'use strict';this.$SphericalViewportControl19={x:v,y:w};this.$SphericalViewportControl5=this.$SphericalViewportControl70(x);this.$SphericalViewportControl71()};u.prototype.isUpdating=function(){'use strict';return this.$SphericalViewportControl8};u.prototype.$SphericalViewportControl106=function(){'use strict';var v=this.$SphericalViewportControl9*(this.$SphericalViewportControl10.right-this.$SphericalViewportControl10.left),w=this.$SphericalViewportControl9*(this.$SphericalViewportControl10.up-this.$SphericalViewportControl10.down);this.$SphericalViewportControl2.updateVelocity(v,w)};u.prototype.$SphericalViewportControl103=function(v){'use strict';var w=c('Event').getKeyCode(v),x=null;switch(w){case c('Keys').LEFT:case s.A:x='left';break;case c('Keys').UP:case s.W:x='up';break;case c('Keys').RIGHT:case s.D:x='right';break;case c('Keys').DOWN:case s.S:x='down';break;}return x};u.prototype.$SphericalViewportControl95=function(){'use strict';return this.$SphericalViewportControl5/this.$SphericalViewportControl28};u.prototype.$SphericalViewportControl56=function(){'use strict';var v='grabbing';if(c('UserAgent').isEngine('WebKit')){v='-webkit-'+v}else if(c('UserAgent').isEngine('Gecko'))v='-moz-'+v;return v};f.exports=u}),null);
__d('compose',[],(function a(b,c,d,e,f,g){function h(){for(var i=arguments.length,j=Array(i),k=0;k<i;k++)j[k]=arguments[k];if(j.length<2)throw new Error('Compose expects two or more functions as arguments.');var l=j.reverse(),m=l[0],n=l[1],o=l.slice(2),p=function q(){return n(m.apply(undefined,arguments))};return o.length===0?p:h.apply(undefined,[p].concat(o).reverse())}f.exports=h}),null);
__d('SphericalMediaCanvasPool',['DOM','Map'],(function a(b,c,d,e,f,g){'use strict';var h=1,i='default',j=function l(m,n){return m+n};function k(){this.$SphericalMediaCanvasPool1=new (c('Map'))();this.$SphericalMediaCanvasPool2=new (c('Map'))()}k.prototype.setLimit=function(l){var m=arguments.length<=1||arguments[1]===undefined?i:arguments[1],n=this.$SphericalMediaCanvasPool2.get(m)||{queue:[],limit:1};n.limit=l;this.$SphericalMediaCanvasPool2.set(m,n)};k.prototype.release=function(l){var m=arguments.length<=1||arguments[1]===undefined?i:arguments[1],n=j(l,m),o=this.$SphericalMediaCanvasPool1.get(n);if(!o)return false;var p=this.$SphericalMediaCanvasPool2.get(m);if(!p||p.queue.length===0)return false;p.queue.splice(p.queue.indexOf(n),1);o.canvas.parentNode&&o.canvas.parentNode.removeChild(o.canvas);return this.$SphericalMediaCanvasPool1['delete'](n)};k.prototype.get=function(l,m){var n=arguments.length<=2||arguments[2]===undefined?i:arguments[2],o=babelHelpers['extends']({},m.canvasAttrs);if(!l||!m.beforeCanvasLost)throw new Error('Missing required arguments.');var p=j(l,n);o['data-id']=o['data-id']||l;var q=this.$SphericalMediaCanvasPool1.get(p);if(q)return q.canvas;var r=this.$SphericalMediaCanvasPool2.get(n)||{queue:[],limit:h},s=void 0;if(r.queue.length<r.limit){s=c('DOM').create('canvas',o)}else{var t=r.queue.shift(),u=this.$SphericalMediaCanvasPool1.get(t);if(!u)throw new Error('Canvas pool could not find the item',t);s=u.canvas;u.beforeCanvasLost();this.$SphericalMediaCanvasPool1['delete'](t);s.className=o.className;s.height=o.height;s.width=o.width;s.tabIndex=o.tabIndex;s.setAttribute('data-id',o['data-id'])}if(!s)throw new Error('Failed to get a canvas.');r.queue.push(p);this.$SphericalMediaCanvasPool2.set(n,r);this.$SphericalMediaCanvasPool1.set(p,{canvas:s,beforeCanvasLost:m.beforeCanvasLost});return s};f.exports=new k()}),null);
__d('SphericalProjectionUtils',['invariant','GLMatrix','degToRad','radToDeg'],(function a(b,c,d,e,f,g,h){var i=c('GLMatrix').vec3,j=c('GLMatrix').mat4,k=Math.acos,l=Math.sin,m=Math.cos,n=15,o=.2,p={convert3dTo2dNormalized:function q(r,s,t,u,v,w,x){var y=c('degToRad')(r),z=c('degToRad')(s),aa=c('degToRad')(t),ba=c('degToRad')(u),ca=c('degToRad')(v),da=j.create();j.perspective(da,ca,w/x,.1,100);var ea=j.create();j.rotateX(ea,ea,z);j.rotateY(ea,ea,y);j.invert(ea,ea);var fa=j.create();j.rotateX(fa,fa,ba);j.rotateY(fa,fa,aa);j.multiply(fa,fa,ea);j.multiply(fa,da,fa);var ga=i.fromValues(0,0,-1);i.transformMat4(ga,ga,fa);var ha=.5+ga[0]/2,ia=.5+ga[1]/2;return {x:ha,y:ia,isNegativeTwin:ga[2]>1}},convert3dTo2dScaled:function q(r,s,t,u,v,w,x){var y=p.convert3dTo2dNormalized.apply(p,arguments),z=y.x,aa=y.y,ba=y.isNegativeTwin;return {x:z*w,y:aa*x,isNegativeTwin:ba}},convert3dTo2dScaledUnique:function q(r,s,t,u,v,w,x){var y=p.convert3dTo2dNormalized.apply(p,arguments),z=y.x,aa=y.y,ba=y.isNegativeTwin;if(ba){z=aa=-1}else{z*=w;aa*=x}return {x:z,y:aa}},convert3dTo2dOnScreen:function q(r,s,t,u,v,w,x){var y=p.convert3dTo2dScaled.apply(p,arguments),z=y.x,aa=y.y,ba=y.isNegativeTwin;if(ba){z=-z;aa=s>0?-x:x}z=Math.max(0,Math.min(w,z));aa=Math.max(0,Math.min(x,aa));return {x:z,y:aa}},convert2dTo3dNormalized:function q(r,s,t,u,v,w,x){r<=1&&r>=-1||h(0);s<=1&&s>=-1||h(0);var y=c('degToRad')(t),z=c('degToRad')(u),aa=c('degToRad')(v),ba=j.create();j.perspective(ba,aa,w/x,.1,100);var ca=-r/ba[0],da=-s/ba[5],ea=y,fa=z,ga=Math.atan(Math.tan(aa/2)*ba[5]/ba[0]),ha=ea+(ca<0?ga:-ga),ia=fa+(da>0?aa/2:-aa/2),ja=void 0,ka=void 0,la=void 0,ma=void 0,na=void 0;ma=na=ja=0;while(ja<n&&!(Math.abs(c('radToDeg')(ha-ea))<o&&Math.abs(c('radToDeg')(ia-fa))<o)){ja++;ka=(ea+ha)/2;la=(fa+ia)/2;var oa=p._getRelativePositionWithoutProjection(y,z,ka,la),pa=oa.x,qa=oa.y;if((da-na)*(da-qa)<=0){ia=la}else{fa=la;na=qa}if((ca-ma)*(ca-pa)<=0){ha=ka}else{ea=ka;ma=pa}}var ra=void 0,sa=void 0;if(ja<n){ra=Math.ceil(c('radToDeg')(ea));sa=Math.ceil(c('radToDeg')(fa))}else{ra=t;sa=u}return {yaw:ra,pitch:sa}},convert2dTo3dScaled:function q(r,s,t,u,v,w,x){var y=w/2,z=x/2;return p.convert2dTo3dNormalized((r-y)*(2/w),(s-z)*(2/x),t,u,v,w,x)},_getRelativePositionWithoutProjection:function q(r,s,t,u){var v=(s-u)/2,w=(s+u)/2,x=Math.cos((r-t)/2),y=Math.sin((r-t)/2),z=Math.cos(v)*x,aa=Math.sin(v)*x,ba=Math.cos(w)*y,ca=Math.sin(w)*y,da=2*aa*ca+2*z*ba,ea=2*ba*ca-2*z*aa,fa=1-2*aa*aa-2*ba*ba;return {x:da/fa,y:ea/fa}},distanceBetweenSphericalCoordinatesDeg:function q(r,s,t,u){return c('radToDeg')(p.distanceBetweenSphericalCoordinatesRad.apply(p,Array.from(arguments).map(c('degToRad'))))},distanceBetweenSphericalCoordinatesRad:function q(r,s,t,u){return k(l(s)*l(u)+m(s)*m(u)*m(r-t))}};f.exports=p}),null);
__d('normalizeDeltaYaw',[],(function a(b,c,d,e,f,g){'use strict';function h(i,j){var k=j?Math.PI:180,l=2*k;if(Math.abs(i)>l){var m=Math.trunc(Math.abs(i)/l);i-=Math.sign(i)*m*l}if(Math.abs(i)>k)i-=Math.sign(i)*2*k;return i}f.exports=h}),null);